# Manipulating the DOM with Refs

- React automatically updates the DOM for us. We just return markup from a component and that markup is added to the DOM by React.
- We do not have to do anything explicitly. So, why are we talking about DOM manipulations ?
- Sometimes you might need access to the DOM elements managed by React—for example, to focus a node, scroll to it, or measure its size and position. 
- There is no built-in way to do those things in React, so you will need a ref to the DOM node.


## Getting a ref to the node 

```tsx
import { useRef } from 'react';
const myRef = useRef(null);
<div ref={myRef}>
```
- When React creates a DOM node for this `div`, React will put a reference to this node into `myRef.current`. In case the node gets updated we will already have a reference to that updated node.
- You can then access this DOM node from your event handlers and use the built-in browser APIs defined on it.


## Example: Focusing a text input

```tsx
 const inputRef = useRef<HTMLInputElement>(null);

  function handleFocusClick() {
    inputRef.current?.focus();
  }

  return (
    <>
      <input type="text" ref={inputRef} />
      <button onClick={handleFocusClick}>Focus</button>
    </>
  );
```

## Example: Scrolling to an element

```tsx
import { useRef } from 'react';

export default function CatFriends() {
  const firstCatRef = useRef(null);
  const secondCatRef = useRef(null);
  const thirdCatRef = useRef(null);

  function handleScrollToFirstCat() {
    firstCatRef.current.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });
  }

  function handleScrollToSecondCat() {
    secondCatRef.current.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });
  }

  function handleScrollToThirdCat() {
    thirdCatRef.current.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });
  }

  return (
    <>
      <nav>
        <button onClick={handleScrollToFirstCat}>
          Neo
        </button>
        <button onClick={handleScrollToSecondCat}>
          Millie
        </button>
        <button onClick={handleScrollToThirdCat}>
          Bella
        </button>
      </nav>
      <div>
        <ul>
          <li>
            <img
              src="https://placecats.com/neo/300/200"
              alt="Neo"
              ref={firstCatRef}
            />
          </li>
          <li>
            <img
              src="https://placecats.com/millie/200/200"
              alt="Millie"
              ref={secondCatRef}
            />
          </li>
          <li>
            <img
              src="https://placecats.com/bella/199/200"
              alt="Bella"
              ref={thirdCatRef}
            />
          </li>
        </ul>
      </div>
    </>
  );
}

```

## Ref callback

- We have learned that we can assign a `useRef` variable to ref attribute on a DOM node.
- Whenever React creates that node, it assigns a reference of that node to `useRef` variable.
- We can also pass a callback function to ref attribute.
- This function runs when the DOM node is created or removed. It's like a listener which runs whenever node is created or removed from DOM.

```tsx
<div ref={(node) => {
  console.log('Attached', node);

  return () => {
    console.log('Clean up', node)
  }
}}>
```

## Manage a list of refs using a ref callback 

- Suppose we have an array and we need a ref to each item of array.
- In that case we would need a collection of refs - array or a map.

```tsx
  const catsRef = useRef(new Map<string, HTMLLIElement>());
  return (
    <ul>
      {catList.map((cat) => (
        <li
          key={cat}
          ref={(node) => {
            catsRef.current.set(cat, node!);
            return () => {
              catsRef.current.delete(cat);
            };
          }}
        >
          <img src={cat} />
        </li>
      ))}
    </ul>
  );
```

## Accessing another component’s DOM nodes 

- Let's say a parent component wants to access the DOM node of it's child component.
- We can define the ref variable in the parent component and pass it to child as a prop.
- Then in the child component, we can set the ref attribute of a DOM node to the ref prop.

```tsx
import { useRef } from 'react';

function MyInput({ ref }) {
  return <input ref={ref} />;
}

function MyForm() {
  const inputRef = useRef(null);
  return <MyInput ref={inputRef} />
}
```
